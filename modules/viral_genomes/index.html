



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="McGill Summer Institue - Genomic Epidemiology of Infectious Diseaes">
      
      
        <link rel="canonical" href="https://sepsis-omics.github.io/mcgill-si-2018/modules/viral_genomes/">
      
      
        <meta name="author" content="Anna Syme, Torsten Seemann">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.4, mkdocs-material-2.9.0">
    
    
      
        <title>Viral genome sequencing - McGill SI 2018 GenEpi</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.4f4f49e8.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../css/sepsis.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#viral-genome-sequencing" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://sepsis-omics.github.io/mcgill-si-2018" title="McGill SI 2018 GenEpi" class="md-header-nav__button md-logo">
          
            <i class="md-icon">blur_on</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                McGill SI 2018 GenEpi
              </span>
              <span class="md-header-nav__topic">
                Viral genome sequencing
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../day1/" title="Day 1" class="md-tabs__link">
          Day 1
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../day2/" title="Day 2" class="md-tabs__link">
          Day 2
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../day3/" title="Day 3" class="md-tabs__link">
          Day 3
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../day4/" title="Day 4" class="md-tabs__link">
          Day 4
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../day5/" title="Day 5" class="md-tabs__link">
          Day 5
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../journal_club/" title="Journal Club" class="md-tabs__link">
          Journal Club
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../extras/" title="Extras" class="md-tabs__link md-tabs__link--active">
          Extras
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">blur_on</i>
      
    </span>
    McGill SI 2018 GenEpi
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Day 1
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Day 1
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day1/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../galaxy-intro-1/" title="Intro to Galaxy" class="md-nav__link">
      Intro to Galaxy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-dna/" title="Training data set" class="md-nav__link">
      Training data set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fastqc/" title="Quality control" class="md-nav__link">
      Quality control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spades/" title="Genome assembly" class="md-nav__link">
      Genome assembly
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Day 2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Day 2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day2/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../kraken/" title="Detecting contamination" class="md-nav__link">
      Detecting contamination
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../snippy/" title="Variant finding" class="md-nav__link">
      Variant finding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../prokka/" title="Genome annotation" class="md-nav__link">
      Genome annotation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Day 3
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Day 3
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day3/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../transmission/" title="Transmission practical" class="md-nav__link">
      Transmission practical
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Day 4
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Day 4
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day4/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abricate/" title="Predicting antimicrobial resistance" class="md-nav__link">
      Predicting antimicrobial resistance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nanopore-ebola/" title="Nanopore viral genomics" class="md-nav__link">
      Nanopore viral genomics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Day 5
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Day 5
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day5/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Journal Club
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Journal Club
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../journal_club/" title="Papers" class="md-nav__link">
      Papers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      Extras
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Extras
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../extras/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../extra/" title="Skills practice" class="md-nav__link">
      Skills practice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../artemis/" title="Viewing genomes with Artemis" class="md-nav__link">
      Viewing genomes with Artemis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflows/" title="Galaxy workflows" class="md-nav__link">
      Galaxy workflows
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Viral genome sequencing
      </label>
    
    <a href="./" title="Viral genome sequencing" class="md-nav__link md-nav__link--active">
      Viral genome sequencing
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" title="Background" class="md-nav__link">
    Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-data" title="Import data" class="md-nav__link">
    Import data
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview" title="Section overview:" class="md-nav__link">
    Section overview:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go-to-the-galaxy-page" title="Go to the Galaxy Page" class="md-nav__link">
    Go to the Galaxy Page
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-files-to-galaxy" title="Import files to Galaxy" class="md-nav__link">
    Import files to Galaxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-make-the-newly-imported-history-appear-as-the-current-history" title="To make the newly imported history appear as the current history:" class="md-nav__link">
    To make the newly imported history appear as the current history:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snippy" title="Snippy" class="md-nav__link">
    Snippy
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_1" title="Section overview:" class="md-nav__link">
    Section overview:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preliminary-activity" title="Preliminary Activity" class="md-nav__link">
    Preliminary Activity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-snippy" title="Running Snippy" class="md-nav__link">
    Running Snippy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artemis" title="Artemis" class="md-nav__link">
    Artemis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_2" title="Section overview:" class="md-nav__link">
    Section overview:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-the-reference-sequence" title="View the reference sequence" class="md-nav__link">
    View the reference sequence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-artemis-window" title="The Artemis window:" class="md-nav__link">
    The Artemis window:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-plot" title="Add a plot" class="md-nav__link">
    Add a plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-a-draft-genome-sequence" title="Producing a draft genome sequence" class="md-nav__link">
    Producing a draft genome sequence
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_3" title="Section overview:" class="md-nav__link">
    Section overview:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examine-the-mapped-reads" title="Examine the mapped reads" class="md-nav__link">
    Examine the mapped reads
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-an-overview-of-the-difference-between-strain-1-151-and-our-new-isolate" title="Getting an Overview of the Difference between strain 1-151 and our new isolate" class="md-nav__link">
    Getting an Overview of the Difference between strain 1-151 and our new isolate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-more-detail-looking-at-the-table-of-snps" title="Getting more detail: looking at the table of SNPs" class="md-nav__link">
    Getting more detail: looking at the table of SNPs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trimmomatic/" title="Read trimming" class="md-nav__link">
      Read trimming
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/" title="Acknowledgements" class="md-nav__link">
      Acknowledgements
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" title="Background" class="md-nav__link">
    Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-data" title="Import data" class="md-nav__link">
    Import data
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview" title="Section overview:" class="md-nav__link">
    Section overview:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go-to-the-galaxy-page" title="Go to the Galaxy Page" class="md-nav__link">
    Go to the Galaxy Page
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-files-to-galaxy" title="Import files to Galaxy" class="md-nav__link">
    Import files to Galaxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-make-the-newly-imported-history-appear-as-the-current-history" title="To make the newly imported history appear as the current history:" class="md-nav__link">
    To make the newly imported history appear as the current history:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snippy" title="Snippy" class="md-nav__link">
    Snippy
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_1" title="Section overview:" class="md-nav__link">
    Section overview:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preliminary-activity" title="Preliminary Activity" class="md-nav__link">
    Preliminary Activity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-snippy" title="Running Snippy" class="md-nav__link">
    Running Snippy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artemis" title="Artemis" class="md-nav__link">
    Artemis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_2" title="Section overview:" class="md-nav__link">
    Section overview:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-the-reference-sequence" title="View the reference sequence" class="md-nav__link">
    View the reference sequence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-artemis-window" title="The Artemis window:" class="md-nav__link">
    The Artemis window:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-plot" title="Add a plot" class="md-nav__link">
    Add a plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-a-draft-genome-sequence" title="Producing a draft genome sequence" class="md-nav__link">
    Producing a draft genome sequence
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_3" title="Section overview:" class="md-nav__link">
    Section overview:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examine-the-mapped-reads" title="Examine the mapped reads" class="md-nav__link">
    Examine the mapped reads
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-an-overview-of-the-difference-between-strain-1-151-and-our-new-isolate" title="Getting an Overview of the Difference between strain 1-151 and our new isolate" class="md-nav__link">
    Getting an Overview of the Difference between strain 1-151 and our new isolate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-more-detail-looking-at-the-table-of-snps" title="Getting more detail: looking at the table of SNPs" class="md-nav__link">
    Getting more detail: looking at the table of SNPs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="viral-genome-sequencing">Viral Genome Sequencing</h1>
<p>This tutorial is about determining the genome sequence of a virus, using comparisons to a reference sequence.</p>
<h2 id="background">Background</h2>
<p>Murray Valley encephalitis virus is classified as part of the Flavivirus genus of viruses, all of which are positive strand RNA viruses. The type species for this genus is yellow fever virus, and the genus includes dengue virus, west nile virus and zika virus.</p>
<p>Viruses from this genus have a single-segment genome of about 11 kb. Within this, there is a 10 kb open reading frame that encodes a polyprotein. Following translation, this protein is modified to yield the various, mature structural and non-structural viral proteins as illustrated in Fig. 1.</p>
<p><img alt="flavivirus" src="./images/flavivirus.png" /></p>
<p>Fig. 1 - An overview of a typical flavivirus genome and the viral proteins that are part of the viral polyprotein (from <a href="http://viralzone.expasy.org/all_by_species/24.html">Viralzone</a>).</p>
<p>There are 14 complete Murray Valley encephalitis virus genome sequences available at NCBI Viral Genomes.</p>
<ul>
<li>Go to NCBI <a href="https://www.ncbi.nlm.nih.gov/genome/viruses/">Viral Genomes</a>.</li>
<li>Select <ss>Browse viral genomes by family</ss> and click on the family <ss>Flaviviridae</ss>: <ss>Complete Genomes</ss></li>
<li>Note: you may have to widen your screen to see all the columns of viral family names.</li>
</ul>
<p><img alt="ncbi_genomes" src="./images/ncbi.png" /></p>
<ul>
<li>Look at the row for Murray Valley encephelitis virus. In the Neigbours column, we can see there are 14.</li>
</ul>
<!--

: click on the 14 and then Entrez Nucleotide

![mvev_neighbours](images/mvev_seqs.png)

This brings up a list of all the strains on NCBI.

following seq though is not in this list?
-->

<p>In this tutorial we will use the prototype strain 1-151 as the reference genome sequence.</p>
<ul>
<li>This strain was isolated in the early 1950s - see <a href="https://www.ncbi.nlm.nih.gov/pubmed/10567642">AF161266</a>.</li>
</ul>
<!-- Dieter
- [are we using this AF seq exactly? or if not, which seq]

- [This seq is not in the list of 14 --- does this mean it is just more distant and therefore didn't align closely?]
-->

<p>The isolate we are looking at has been sequenced using the Illumina platform.</p>
<ul>
<li>The genomic cDNA was prepared using random hexamers to prime the reverse transcription of the viral genomic RNA.</li>
<li>After second strand synthesis, the cDNA was used to prepare an Illumina sequencing library and run on an Illumina MiSeq instrument.</li>
</ul>
<p>In this activity we will use a read mapping approach to determine the sequence of a new Murray Valley encephalitis virus isolate.</p>
<h2 id="import-data">Import data</h2>
<h3 id="section-overview">Section overview:</h3>
<ul>
<li>Log in to your Galaxy server</li>
<li>Import files required for the activity</li>
<li>View imported files</li>
</ul>
<h3 id="go-to-the-galaxy-page">Go to the Galaxy Page</h3>
<ul>
<li>Web address: <a href="http://phln.genome.edu.au/galaxy">http://phln.genome.edu.au/galaxy</a></li>
<li><a href="https://docs.google.com/document/d/10meAZA7-OsD_PglLD2zL3m-EwkemFxVnRVUYGAmtOz4/pub">Remind me how to logon</a></li>
</ul>
<h3 id="import-files-to-galaxy">Import files to Galaxy</h3>
<ul>
<li>Click on the <ss>Analyze Data</ss> menu at the top of the page.</li>
<li>Click on the <ss>History</ss> menu button (the <img alt="cog" src="./images/cog.png" /> on the top right of the history pane)</li>
<li>Click <ss>Import from File</ss> (at the bottom of the list)</li>
<li>A new page will appear with a text box for the URL of the history to import.</li>
<li>Copy the following URL into the text box:</li>
<li>
<p><fn>http://phln.genome.edu.au/public/dieter/Galaxy-History-MVEVmapping.tar.gz</fn></p>
</li>
<li>
<p>Click <ss>Submit</ss></p>
</li>
<li>Galaxy will download the data files from the internet and will be available as an additional history (takes about one minute).</li>
</ul>
<h3 id="to-make-the-newly-imported-history-appear-as-the-current-history">To make the newly imported history appear as the current history:</h3>
<ul>
<li>Click on the View all Histories button (the <img alt="Galaxy-histories" src="./images/Galaxy-histories.png" /> on the top right of the history pane.)</li>
<li>If the history has finished downloading it will appear with the title:</li>
<li><fn>“imported from archive: MVEVmapping“</fn></li>
<li>Click on the <ss>Switch to</ss> button above this history and then the <ss>Done</ss> button.</li>
</ul>
<p>You should now have 4 files in the history pane as follows:</p>
<p><img alt="mvev_files" src="./images/mvev_files.png" /></p>
<p>Reference sequence files <!-- Dieter: [from AF161266?]--> :</p>
<ul>
<li><fn>MVEV.gbk</fn> - genbank format</li>
<li><fn>MVEV.fna</fn> - fasta format</li>
</ul>
<p>Illumina sequence reads (R1 and R2) from the new isolate:</p>
<ul>
<li><fn>MVE_R1.fq</fn> - forward reads</li>
<li><fn>MVE_R2.fq</fn> - reverse reads</li>
</ul>
<h2 id="snippy">Snippy</h2>
<h3 id="section-overview_1">Section overview:</h3>
<ul>
<li>Find variants in the isolate using the tool Snippy.</li>
</ul>
<p>Snippy is a fast variant caller for haploid genomes. The software is available on GitHub at <a href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</a>. For this activity, we are using Snippy as installed on Galaxy.</p>
<h3 id="preliminary-activity">Preliminary Activity</h3>
<ul>
<li>
<p>Run FastQC: How many reads in in each of the fastq files <fn>MVE_R1.fq</fn> and <fn>MVE_R2.fq</fn>?</p>
</li>
<li>
<p><fn>MVEV.fna</fn> and <fn>MVEV.gbk</fn> each contain the genome sequence of Murray Valley encephalitis virus strain 1-151 - how many bases in the genome? (Hint: use Fasta Statistics)</p>
</li>
</ul>
<h3 id="running-snippy">Running Snippy</h3>
<p>Snippy maps reads from the new Murray Valley encephalitis virus isolate (the <fn>MVE_R1.fq</fn> and <fn>MVE_R2.fq</fn> reads) onto the genome sequence of Murray Valley encephalitis virus strain 1-151 (<fn>MVEV.fna</fn>). <!-- Dieter: [or gbk? that's in the screenshot] --></p>
<ul>
<li>Find Snippy in the tool menu (in  NGS: Variant Analysis)</li>
<li>Select appropriate files (see screenshot below) and Execute (use default settings).</li>
</ul>
<p><img alt="snippy_window" src="./images/snippy.png" /></p>
<h3 id="output">Output</h3>
<p>Files cataloging SNP differences:</p>
<ul>
<li>9: <fn>snippy on data 4, data 3, and data 2 snps vcf file</fn></li>
<li>10: <fn>snippy on data 4, data 3, and data 2 snps gff file</fn></li>
<li>11: <fn>snippy on data 4, data 3, and data 2 snps table</fn></li>
<li>12: <fn>snippy on data 4, data 3, and data 2 snps summary</fn></li>
</ul>
<p>A log of the progress of the run:</p>
<ul>
<li>13: <fn>snippy on data 4, data 3, and data 2 log file</fn></li>
</ul>
<p>Regions where reads aligned (NNNN &mdash;, indicate regions where there was low or no read data):</p>
<ul>
<li>14: <fn>snippy on data 4, data 3, and data 2 aligned fasta</fn></li>
</ul>
<p>A consensus genome sequence for the new isolate:</p>
<ul>
<li>15: <fn>snippy on data 4, data 3, and data 2 consensus fasta</fn></li>
</ul>
<p>Summary of the read depth:</p>
<ul>
<li>16: <fn>snippy on data 4, data 3, and data 2 mapping depth</fn></li>
</ul>
<p>A compressed version of the above files (and more that can be downloaded):</p>
<ul>
<li>17: <fn>snippy on data 4, data 3, and data 2 out dir</fn></li>
</ul>
<p>Download these files to your local computer (click on the file name and then the disk icon in the lower left hand corner):</p>
<ul>
<li>17: <fn>snippy on data 4, data 3, and data 2 out dir</fn> (and unzip)</li>
<li>2: <fn>MVEV.gbk</fn></li>
<li>1: <fn>MVEV.fna</fn></li>
</ul>
<p>Also download these bam files from these URLs (open each URL in a new tab and the file should download automatically):</p>
<ul>
<li><a href="http://phln.genome.edu.au/public/dieter/snps.bam">http://phln.genome.edu.au/public/dieter/snps.bam</a></li>
<li><a href="http://phln.genome.edu.au/public/dieter/snps.bam.bai">http://phln.genome.edu.au/public/dieter/snps.bam.bai</a></li>
<li><a href="http://phln.genome.edu.au/public/dieter/snps.depth.gz">http://phln.genome.edu.au/public/dieter/snps.depth.gz</a></li>
<li><a href="http://phln.genome.edu.au/public/dieter/snps.depth.gz.tbi">http://phln.genome.edu.au/public/dieter/snps.depth.gz.tbi</a></li>
</ul>
<p>Note: if you have previously downloaded these files, the new downloads may be renamed. Remove any spaces in the names.</p>
<!-- Dieter:
[Should we explain why we have these four other files - where they are from, what they are needed for, etc - so if people are repeating this exercise on their own they can follow]

-->

<h2 id="artemis">Artemis</h2>
<h3 id="section-overview_2">Section overview:</h3>
<ul>
<li>View the reads from the new isolate mapped against the reference sequence, using the tool Artemis.</li>
</ul>
<p>Artemis is a tool to view genome sequences and mapped reads, including variants (SNPs).</p>
<p>If Artemis is not installed, go to <a href="http://www.sanger.ac.uk/science/tools/artemis">http://www.sanger.ac.uk/science/tools/artemis</a>.</p>
<h3 id="view-the-reference-sequence">View the reference sequence</h3>
<ul>
<li>Open Artemis.</li>
<li>Go to <ss>File: Open</ss> and select <fn>MVEV.gbk</fn>. The file will probably have a &ldquo;Galaxy&rdquo; prefix, e.g. <fn>Galaxy2-[MVEV.gbk].genbank</fn>.</li>
</ul>
<h3 id="the-artemis-window">The Artemis window:</h3>
<ul>
<li>panes 1 and 2 are the same, but can be scaled differently</li>
<li>each pane has the double-stranded sequence in the centre, with amino acid translations above and below</li>
<li>there is a third lower pane with feature information</li>
<li>coding sequences are highlighted in blue</li>
<li>other features are highlighted in green</li>
<li>clicking on one of these will select it in all panels</li>
<li>black vertical lines are stop codons (when zoomed out)</li>
<li>move left and right with horizontal scroll bar</li>
<li>zoom in and out with right-hand scroll bar</li>
</ul>
<p><img alt="artemis_window" src="./images/artemis.png" /></p>
<h3 id="add-a-plot">Add a plot</h3>
<ul>
<li>Go to <ss>Graph: Add User Plot</ss>, select <fn>snps.depth.gz</fn></li>
<li>A graph should display at the top of the screen <!-- Dieter:  [is this depth of reads or depth of snps?] --></li>
</ul>
<p><img alt="depth-plot" src="./images/depth-plot.png" /></p>
<!-- need to finish this bit :

The file that is used to produce the graph is a 3 column table (part of the file is shown below)

[what is the file name?]

                 …
Column 1: the name of the sequence, Column 2: the position in the sequence, Column 1: the read depth at that position

-->

<h2 id="producing-a-draft-genome-sequence">Producing a draft genome sequence</h2>
<h3 id="section-overview_3">Section overview:</h3>
<ul>
<li>Produce draft genome sequence for the new viral isolate.</li>
</ul>
<h3 id="examine-the-mapped-reads">Examine the mapped reads</h3>
<!-- [or title for this section? ] -->

<p>What is the minimum read depth used by Snippy to call a SNP?</p>
<ul>
<li>Hint: Go back to Snippy on Galaxy - look at the information below the ‘Execute’ button</li>
</ul>
<p>Would Snippy call a SNP at positions 1 → 5 ?</p>
<p>What is the maximum read depth?</p>
<p>What do we know about the sequence of the new isolate in the regions where there is low read coverage?</p>
<!-- [close first Artemis window?] -->

<ul>
<li>Unzip <fn>17: snippy on data 4, data 3, and data 2 out dir</fn></li>
<li>
<p>This makes an &ldquo;out&rdquo; folder containing some files including the consensus file.</p>
</li>
<li>
<p>In Artemis, open <fn>snps.consensus.fa</fn></p>
</li>
</ul>
<p>This is a file that is based on the reference sequence and includes any confirmed SNPs called by Snippy.</p>
<p>If we were going to use this sequence to produce the draft sequence of the new isolate, what bases would you have at positions 1→ 5?</p>
<h3 id="getting-an-overview-of-the-difference-between-strain-1-151-and-our-new-isolate">Getting an Overview of the Difference between strain 1-151 and our new isolate</h3>
<p>Simplest overview: view the bam file with Artemis</p>
<p>Open <fn>MVEV.gbk</fn> in Artemis and load the <fn>snps.bam</fn> via the File menu to “Read BAM / VCF”</p>
<p>Once loaded, differences between reads and the reference sequence can be highlighted by right/command click in the bam view window. Select ‘Show &gt; SNP marks’.</p>
<p><img alt="bam" src="./images/bam.png" /></p>
<h3 id="getting-more-detail-looking-at-the-table-of-snps">Getting more detail: looking at the table of SNPs</h3>
<p>Located in the out folder there is a html file that contains a table with information about each of the SNPs called by Snippy.</p>
<p>Included in the table is a column that provides a prediction about the impact each SNP will have on annotated protein coding regions. The genbank file provides the annotation information used by Snippy to make the predictions.</p>
<p>A total of 790 SNP differences were call by Snippy</p>
<p>Open snps.html in your web browser</p>
<!-- [screenshot] -->

<p>Summary: 663/790 SNPs do not result a difference in the encoded polyprotein</p>
<p>Is this pattern of variable genome sequence and more conserved protein sequence normal in viruses? What might be the cause?</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../workflows/" title="Galaxy workflows" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Galaxy workflows
              </span>
            </div>
          </a>
        
        
          <a href="../trimmomatic/" title="Read trimming" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Read trimming
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; Melbourne Bioinformatics, The University of Melbourne, Australia.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="http://bit.ly/GenomicEpi18" class="md-footer-social__link fa fa-dropbox"></a>
    
      <a href="https://github.com/sepsis-omics/mcgill-si-2018" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://github.com/sepsis-omics/mcgill-si-2018/issues" class="md-footer-social__link fa fa-bug"></a>
    
      <a href="https://twitter.com/MelBioInf" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.melbournebioinformatics.org.au/" class="md-footer-social__link fa fa-internet-explorer"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>