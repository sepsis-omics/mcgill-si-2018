



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="McGill Summer Institue - Genomic Epidemiology of Infectious Diseaes">
      
      
        <link rel="canonical" href="https://sepsis-omics.github.io/mcgill-si-2018/modules/trimmomatic/">
      
      
        <meta name="author" content="Anna Syme, Torsten Seemann">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.4, mkdocs-material-2.9.0">
    
    
      
        <title>Read trimming - McGill SI 2018 GenEpi</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.4f4f49e8.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../css/sepsis.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#trimming-reads" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://sepsis-omics.github.io/mcgill-si-2018" title="McGill SI 2018 GenEpi" class="md-header-nav__button md-logo">
          
            <i class="md-icon">blur_on</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                McGill SI 2018 GenEpi
              </span>
              <span class="md-header-nav__topic">
                Read trimming
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">blur_on</i>
      
    </span>
    McGill SI 2018 GenEpi
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Day 1
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Day 1
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day1/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../galaxy-intro-1/" title="Intro to Galaxy" class="md-nav__link">
      Intro to Galaxy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-dna/" title="Training data set" class="md-nav__link">
      Training data set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fastqc/" title="Quality control" class="md-nav__link">
      Quality control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spades/" title="Genome assembly" class="md-nav__link">
      Genome assembly
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Day 2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Day 2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day2/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../kraken/" title="Detecting contamination" class="md-nav__link">
      Detecting contamination
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../snippy/" title="Variant finding" class="md-nav__link">
      Variant finding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../prokka/" title="Genome annotation" class="md-nav__link">
      Genome annotation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Day 3
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Day 3
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day3/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Day 4
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Day 4
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day4/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abricate/" title="Predicting antimicrobial resistance" class="md-nav__link">
      Predicting antimicrobial resistance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nanopore-ebola/" title="Nanopore viral genomics" class="md-nav__link">
      Nanopore viral genomics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Day 5
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Day 5
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day5/" title="Agenda" class="md-nav__link">
      Agenda
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Extra
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Extra
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../artemis/" title="Artemis" class="md-nav__link">
      Artemis
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Read trimming
      </label>
    
    <a href="./" title="Read trimming" class="md-nav__link md-nav__link--active">
      Read trimming
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" title="Learning Objectives" class="md-nav__link">
    Learning Objectives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#start" title="Start" class="md-nav__link">
    Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trimmomatic-functions" title="Trimmomatic functions" class="md-nav__link">
    Trimmomatic functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-trimmomatic" title="Run Trimmomatic" class="md-nav__link">
    Run Trimmomatic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examine-output" title="Examine output" class="md-nav__link">
    Examine output
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflows/" title="Galaxy workflows" class="md-nav__link">
      Galaxy workflows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../viral_genomes/" title="Viral genome sequencing" class="md-nav__link">
      Viral genome sequencing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../journal_club/" title="Journal Club" class="md-nav__link">
      Journal Club
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/" title="Authors" class="md-nav__link">
      Authors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" title="Learning Objectives" class="md-nav__link">
    Learning Objectives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#start" title="Start" class="md-nav__link">
    Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trimmomatic-functions" title="Trimmomatic functions" class="md-nav__link">
    Trimmomatic functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-trimmomatic" title="Run Trimmomatic" class="md-nav__link">
    Run Trimmomatic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examine-output" title="Examine output" class="md-nav__link">
    Examine output
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="trimming-reads">Trimming reads</h1>
<h2 id="introduction">Introduction</h2>
<p>After checking your input sequence reads for quality (e.g. using FastQC) it might be necessary to trim the reads. Here we will use the Trimmomatic tool. For more inforamtion, see the Trimmomatic <a href="http://www.usadellab.org/cms/index.php?page=trimmomatic">webpage</a> and the <a href="http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/TrimmomaticManual_V0.32.pdf">manual.</a></p>
<h2 id="learning-objectives">Learning Objectives</h2>
<p>At the end of this tutorial you should be able to:</p>
<ol>
<li>input sequence reads to Trimmomatic</li>
<li>trim using appropriate parameters, and</li>
<li>examine the output trimmed reads.</li>
</ol>
<h2 id="start">Start</h2>
<ul>
<li>open your Galaxy instance</li>
<li>find your quality-checked Illumina sequence reads</li>
<li>e.g. <fn>mutant_R1.fastq</fn> and <fn>mutant_R2.fastq</fn></li>
<li>We want to trim the parts of the reads that are of low quality</li>
<li>based on the FastQC results, we might want to trim the reads like this:<ul>
<li>trim Illumina adapters</li>
<li>leading and trailing bases - trim if quality is below 15</li>
<li>sliding window - trim once average quality is below 20</li>
</ul>
</li>
</ul>
<h2 id="trimmomatic-functions">Trimmomatic functions</h2>
<ul>
<li>
<p>Adapter trimming</p>
<ul>
<li>This function trims adapters, barcodes and other contaminants from the reads.</li>
<li>You need to supply a FASTA file of possible adapter sequences, barcodes etc to trim. See Trimmomatic website for detailed instructions.</li>
<li>The default quality settings are sensible.</li>
<li>This should always be the first trimming step if it is used.</li>
</ul>
</li>
<li>
<p>Sliding window trimming</p>
<ul>
<li>This function uses a sliding window to measure average quality and trims accordingly.</li>
<li>The default quality parameters are sensible for this step.</li>
</ul>
</li>
<li>
<p>Trailing bases quality trimming</p>
<ul>
<li>This function trims bases from the end of a read if they drop below a quality threshold. e.g. If base 69 of 75 drops below the threshold, the read is cut to 68 bases.</li>
<li>Use FastQC report to decide whether this step is warranted and what quality value to use. A quality threshold value of 10-15 is a good starting point.</li>
</ul>
</li>
<li>
<p>Leading bases quality trimming</p>
<ul>
<li>This function works in a similar fashion to trailing bases trimming except it performs it at the start of the reads.</li>
<li>Use FastQC report to determine if this step is warranted. If the quality of bases is poor at the beginning of reads it might be necessary.</li>
</ul>
</li>
<li>
<p>Minimum read length</p>
<ul>
<li>Once all trimming steps are complete, this function makes sure that the reads are still longer than this value. If not, the read is removed from the file and its pair is put into the orphan file.</li>
<li>The most appropriate value for this parameter will depend on the FastQC report, specifically the length of the high quality section of the Per Base Sequence Quality graph.</li>
</ul>
</li>
<li>
<p>Each read library should be trimmed separately with parameters dependent on their own FastQC reports.</p>
</li>
</ul>
<h2 id="run-trimmomatic">Run Trimmomatic</h2>
<!---
FIXME: change these settings if required (examine FastQC reports)
--->

<ul>
<li>Go to <ss>Tools &rarr; NGS Analysis &rarr; NGS: QC and manipulation &rarr; Trimmomatic</ss>.</li>
<li><ss>Input FASTQ file (R1/first of pair)</ss>: <fn>mutant_R1.fastq</fn></li>
<li><ss>Input FASTQ file (R2/second of pair)</ss>: <fn>mutant_R2.fastq</fn></li>
<li><ss>Perform initial ILLUMINACLIP step </ss>: <em>Yes</em>
&lt;!&mdash;</li>
<li><ss>Adapter sequences to use</ss>: FIXME
&mdash;&gt;</li>
<li><ss>How accurate the match between the two &lsquo;adapter ligated&rsquo; reads must be for PE palindrome read alignment</ss>: 40</li>
<li><ss>How accurate the match between any adapter etc. sequence must be against a read</ss>: 15</li>
<li>leave the first <ss>Trimmomatic Operation</ss> as is</li>
<li>click on <ss>+ Insert Trimmomatic Operation</ss></li>
<li><ss>Select Trimmomatic operation to perform</ss>: <em>Cut bases off the start of a read, if below a threshold quality (LEADING)</em></li>
<li><ss>Minimum quality required to keep a base</ss>: 15</li>
<li>click on <ss>+ Insert Trimmomatic Operation</ss></li>
<li><ss>Select Trimmomatic operation to perform</ss>: <em>Cut bases off the end of a read, if below a threshold quality (TRAILING)</em></li>
<li><ss>Minimum quality required to keep a base</ss>: 15</li>
<li>click <ss>Execute</ss></li>
</ul>
<!---
FIXME: screenshot of these trimmomatic options selected
--->

<h2 id="examine-output">Examine output</h2>
<p>Trimmomatic should produce 2 pairs files (1 left and 1 right hand end) and 1 or 2 single “orphaned reads” files.</p>
<p>The output files are the ones you should use for assembly.</p>
<p>There are four output files, still in FASTQ format:</p>
<ul>
<li>R1 reads that have a pair in the R2 file</li>
<li>R2 reads that have a pair in the R1 file</li>
<li>R1 reads with no pair (R2 match was low quality: deleted)</li>
<li>R2 reads with no pair (R1 match was low quality: deleted)</li>
</ul>
<p>Examine each file with the eye icon. Look for:</p>
<ul>
<li>Number of reads orphaned by the trimming / cleanup process.</li>
<li>Number of pairs lost totally.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../artemis/" title="Artemis" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Artemis
              </span>
            </div>
          </a>
        
        
          <a href="../workflows/" title="Galaxy workflows" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Galaxy workflows
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; Melbourne Bioinformatics, The University of Melbourne, Australia.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="http://bit.ly/GenomicEpi18" class="md-footer-social__link fa fa-dropbox"></a>
    
      <a href="https://github.com/sepsis-omics/mcgill-si-2018" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://github.com/sepsis-omics/mcgill-si-2018/issues" class="md-footer-social__link fa fa-bug"></a>
    
      <a href="https://twitter.com/MelBioInf" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.melbournebioinformatics.org.au/" class="md-footer-social__link fa fa-internet-explorer"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>